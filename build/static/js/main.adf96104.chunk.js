(this["webpackJsonpmini-app"]=this["webpackJsonpmini-app"]||[]).push([[0],{167:function(e,t,c){},170:function(e,t,c){"use strict";c.r(t);var n=c(0),s=c(36),i=c.n(s),a=c(13),r=c.n(a),o=c(26),j=c(51),l=c(8),d=c(47),b=c.n(d),O=c(3),u=(c(161),c(57)),h=c(48),x=c.n(h),m=c(1),f=function(e){var t=e.id,c=e.go;e.fetchedUser;return Object(m.jsxs)(O.n,{id:t,children:[Object(m.jsx)(O.o,{children:"\u041d\u0430\u0445\u043e\u0434\u0447\u0438\u0432\u044b\u0439 \u0448\u043f\u0438\u043e\u043d"}),Object(m.jsx)(O.i,{children:Object(m.jsxs)(O.f,{children:[Object(m.jsx)(O.d,{size:"m",stretched:!0,className:x.a.btn,onClick:c,"data-to":"new",children:"\u041d\u043e\u0432\u0430\u044f \u0438\u0433\u0440\u0430"}),Object(m.jsx)(O.d,{className:x.a.btn,mode:"secondary",size:"m",stretched:!0,onClick:c,"data-to":"locs",children:"\u0421\u043f\u0438\u0441\u043e\u043a \u043b\u043e\u043a\u0430\u0446\u0438\u0439"})]})})]})},p=c(38),g=c.n(p),v=function(e){var t=e.img,c=e.location,n=e.role;return Object(m.jsxs)("div",{className:g.a.location,children:[Object(m.jsx)("div",{className:g.a.title,children:c}),"object"!=typeof n?Object(m.jsx)("div",{className:g.a.role,children:n}):null,Object(m.jsx)("img",{className:g.a.img,src:t})]})},_=function(e){var t=e.locations,c=e.go;return Object(m.jsxs)("div",{children:[Object(m.jsx)(O.d,{size:"m",stretched:!0,"data-to":"newLocation",onClick:c,children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e"}),t.map((function(e,t){return Object(m.jsx)(v,{img:e.img,location:e.location,role:e.role},t)}))]})},y=function(e){var t=e.id,c=e.go,n=e.locations;return Object(m.jsxs)(O.n,{id:t,children:[Object(m.jsx)(O.o,{left:Object(m.jsx)(O.p,{onClick:c,"data-to":"home"}),children:"\u0421\u043f\u0438\u0441\u043e\u043a \u041b\u043e\u043a\u0430\u0446\u0438\u0439"}),Object(m.jsx)(O.i,{children:Object(m.jsx)(O.f,{children:Object(m.jsx)(_,{go:c,locations:n})})})]})},S=(c(167),function(e){var t=e.id,c=e.go,s=(e.play,e.fetchedUser),i=e.socket,a=e.locations,j=Object(n.useState)(null),d=Object(l.a)(j,2),b=d[0],u=d[1],h=Object(n.useState)([]),x=Object(l.a)(h,2),f=x[0],p=x[1],g=Object(n.useState)(),v=Object(l.a)(g,2),_=v[0],y=(v[1],Object(n.useState)()),S=Object(l.a)(y,2),k=S[0],z=S[1],C=Object(n.useState)(!1),N=Object(l.a)(C,2),T=N[0],w=N[1],L=Object(n.useState)(null),F=Object(l.a)(L,2),A=F[0],K=F[1];""!==_&&i.emit("join_room",s.id);return Object(n.useEffect)((function(){i.on("invited",(function(e){p([].concat(Object(o.a)(f),[e.from])),z(e.users)})),i.on("invite_accept",(function(e){var t=[];e.users.forEach((function(c,n){c.id==e.from&&(c.status="\u043f\u0440\u0438\u043d\u044f\u0442\u043e"),t.push(c)})),u(t)}))}),[i]),Object(m.jsxs)(O.n,{id:t,children:[Object(m.jsx)(O.o,{left:Object(m.jsx)(O.p,{onClick:c,"data-to":"home"}),children:"\u041d\u043e\u0432\u0430\u044f \u0438\u0433\u0440\u0430"}),T?Object(m.jsxs)(O.i,{children:[Object(m.jsx)(O.j,{children:"\u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0441\u043e\u0437\u0434\u0430\u0442\u0435\u043b\u044f"}),Object(m.jsx)(O.l,{children:Object(m.jsxs)("div",{style:{display:"flex"},children:[Object(m.jsx)(O.k,{style:{width:"260px"},size:"s",header:A.first_name,subtitle:Object(m.jsx)("span",{style:{color:"green"},children:"\u0433\u043b\u0430\u0432\u043d\u044b\u0439"}),children:Object(m.jsx)(O.c,{src:A.photo_200})}),b?b.map((function(e,t){return Object(m.jsx)(O.k,{style:{width:"260px"},size:"s",header:e.first_name,subtitle:"\u043e\u0436\u0438\u0434\u0430\u043d\u0438\u0435"==e.status?Object(m.jsx)("span",{children:e.status}):Object(m.jsx)("span",{style:{color:"green"},children:e.status}),children:Object(m.jsx)(O.c,{src:e.photo_200})},e.id)})):null]})})]}):Object(m.jsxs)(O.i,{children:[Object(m.jsx)(O.j,{children:b?Object(m.jsx)(m.Fragment,{children:"\u041e\u0436\u0438\u0434\u0430\u043d\u0438\u0435 \u0434\u0440\u0443\u0437\u0435\u0439"}):Object(m.jsx)(m.Fragment,{children:"\u0421\u043e\u0437\u0434\u0430\u0439\u0442\u0435 \u043a\u043e\u043c\u043d\u0430\u0442\u0443 \u0441 \u0434\u0440\u0443\u0437\u044c\u044f\u043c\u0438"})}),b?Object(m.jsx)(O.l,{children:Object(m.jsxs)("div",{style:{display:"flex"},children:[Object(m.jsx)(O.k,{style:{width:"260px"},size:"s",header:s.first_name,subtitle:Object(m.jsx)("span",{style:{color:"green"},children:"\u0432\u044b"}),children:Object(m.jsx)(O.c,{src:s.photo_200})}),b.map((function(e,t){return Object(m.jsx)(O.k,{style:{width:"250px"},size:"s",header:e.first_name,subtitle:"\u043e\u0436\u0438\u0434\u0430\u043d\u0438\u0435"==e.status?Object(m.jsx)("span",{children:e.status}):Object(m.jsx)("span",{style:{color:"green"},children:e.status}),children:Object(m.jsx)(O.c,{src:e.photo_200})},e.id)}))]})}):null]}),b&&!T?Object(m.jsx)(O.f,{children:Object(m.jsx)(O.d,{stretched:!0,size:"m","data-users":JSON.stringify(b),"data-to":"game",onClick:function(e){i.emit("game_start",{locations:a,room:s.id,users:[].concat(Object(o.a)(b),[s])})},children:"\u041d\u0430\u0447\u0430\u0442\u044c \u0438\u0433\u0440\u0443"})}):Object(m.jsx)(m.Fragment,{children:T?null:Object(m.jsx)(O.f,{children:Object(m.jsx)(O.d,{size:"m",mode:"secondary",stretched:!0,onClick:function(){r.a.send("VKWebAppGetFriends",{multi:!0}).then((function(e){u(e.users);var t=[];e.users.forEach((function(e){var c=e,n=Object.assign({status:"\u043e\u0436\u0438\u0434\u0430\u043d\u0438\u0435"},c);t.push(n),i.emit("invite",{from:s,to:e.id,users:t})})),u(t)}))},children:"\u041f\u0440\u0438\u0433\u043b\u0430\u0441\u0438\u0442\u044c \u0434\u0440\u0443\u0437\u0435\u0439"})})}),Object(m.jsx)(O.i,{children:Object(m.jsx)("div",{children:f&&!b?Object(m.jsxs)(m.Fragment,{children:[Object(m.jsx)(O.j,{children:"\u0412\u0430\u0448\u0438 \u043f\u0440\u0438\u0433\u043b\u0430\u0448\u0435\u043d\u0438\u044f"}),f.map((function(e,t){return Object(m.jsxs)(O.f,{style:{display:"flex"},children:[Object(m.jsx)(O.c,{size:"72px",src:e.photo_200}),Object(m.jsxs)("div",{style:{marginLeft:"16px"},children:[Object(m.jsxs)("div",{children:[e.first_name," ",e.last_name]}),Object(m.jsx)(O.d,{style:{marginTop:"16px"},"data-to":JSON.stringify(e),onClick:function(e){!function(e){var t=JSON.parse(e.currentTarget.dataset.to);i.emit("leave_room",s.id),i.emit("join_room",t.id),p(null),w(!0),K(t),i.emit("accept",{from:s.id,to:t.id,users:k})}(e)},children:"\u041f\u0440\u0438\u043d\u044f\u0442\u044c"})]})]},t)}))]}):null})})]})}),k=c.p+"static/media/shpion.fd50b023.png",z=c(44),C=function(e){var t=e.id,c=e.go,s=e.players,i=(e.locations,e.location),a=e.spy,r=(e.setLocation,e.socket),o=e.fetchedUser,j=e.flash,d=e.room,b=Object(n.useState)(null),u=Object(l.a)(b,2),h=(u[0],u[1],Object(n.useState)(!1)),x=Object(l.a)(h,2),f=(x[0],x[1],Object(n.useState)(!1)),p=Object(l.a)(f,2),g=(p[0],p[1],Object(n.useState)(!1)),_=Object(l.a)(g,2),y=(_[0],_[1],Object(n.useState)(null)),S=Object(l.a)(y,2),C=(S[0],S[1],function(){return Object(m.jsxs)("div",{children:["\u0412\u0440\u0435\u043c\u044f \u0432\u044b\u0448\u043b\u043e! ",a.first_name," ",a.last_name," \u0431\u044b\u043b(\u0430) \u0448\u043f\u0438\u043e\u043d\u043e\u043c!",Object(m.jsx)("br",{}),Object(m.jsx)(O.d,{style:{marginTop:"16px"},"data-to":"home",onClick:c,size:"m",stretched:!0,children:"\u041d\u0430 \u0433\u043b\u0430\u0432\u043d\u044b\u0439 \u044d\u043a\u0440\u0430\u043d"})]})});return Object(n.useEffect)((function(){}),[r]),Object(m.jsxs)(O.n,{id:t,children:[Object(m.jsx)(O.o,{children:"\u0418\u0433\u0440\u0430"}),Object(m.jsxs)(O.i,{children:[Object(m.jsx)(O.f,{children:Object(m.jsx)(z.a,{date:Date.now()+1e3*s.length,renderer:function(e){var t=e.minutes,c=e.seconds;return e.completed?(j(),r.emit("leave_room",d),setTimeout((function(){r.emit("join_room",o.id)}),1e3),Object(m.jsx)(C,{})):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{children:[t,":",1==String(c).length?"0"+c:c]}),Object(m.jsx)("div",{children:"\u041d\u0430\u0447\u0438\u043d\u0430\u0439\u0442\u0435 \u0437\u0430\u0434\u0430\u0432\u0430\u0442\u044c \u0432\u043e\u043f\u0440\u043e\u0441\u044b \u0434\u0440\u0443\u0433 \u0434\u0440\u0443\u0433\u0443!"})]})}})}),o.id==a.id?Object(m.jsx)(O.f,{children:Object(m.jsx)(v,{img:k,location:"\u0412\u044b \u0448\u043f\u0438\u043e\u043d",role:"\u0412\u044b\u0447\u0438\u0441\u043b\u0438\u0442\u0435 \u043b\u043e\u043a\u0430\u0446\u0438\u044e \u0438\u0433\u0440\u043e\u043a\u043e\u0432"})}):Object(m.jsx)(O.f,{children:Object(m.jsx)(v,{img:i.img,location:i.location,role:i.role[function(e,t){var c=e-.5+Math.random()*(t-e+1);return Math.round(c)}(0,i.role.length-1)]})})]})]})},N=c(39),T=c.n(N),w=function(e){var t=e.id,c=e.go,n=e.players,s=e.flash,i=e.mafia,a=function(){return Object(m.jsxs)("div",{children:["\u0412\u0440\u0435\u043c\u044f \u0432\u044b\u0448\u043b\u043e! ",i," \u0431\u044b\u043b(\u0430) \u0448\u043f\u0438\u043e\u043d\u043e\u043c!"]})};return Object(m.jsxs)(O.n,{id:t,children:[Object(m.jsx)(O.o,{children:"\u0422\u0430\u0439\u043c\u0435\u0440"}),Object(m.jsxs)(O.f,{children:[Object(m.jsx)(z.a,{date:Date.now()+6e4*n.length,renderer:function(e){var t=e.minutes,c=e.seconds;return e.completed?(s(),Object(m.jsx)(a,{})):Object(m.jsxs)(m.Fragment,{children:[Object(m.jsxs)("div",{className:T.a.timer,children:[t,":",1==String(c).length?"0"+c:c]}),Object(m.jsx)("div",{className:T.a.text,children:"\u041d\u0430\u0447\u0438\u043d\u0430\u0439\u0442\u0435 \u0437\u0430\u0434\u0430\u0432\u0430\u0442\u044c \u0432\u043e\u043f\u0440\u043e\u0441\u044b \u0434\u0440\u0443\u0433 \u0434\u0440\u0443\u0433\u0443!"})]})}}),Object(m.jsx)(O.d,{className:T.a.btn,size:"m",stretched:!0,onClick:c,"data-to":"game",children:"\u041d\u043e\u0432\u044b\u0439 \u0440\u0430\u0443\u043d\u0434"}),Object(m.jsx)(O.d,{className:T.a.btn,size:"m",mode:"secondary",stretched:!0,onClick:c,"data-to":"home",children:"\u0412 \u0433\u043b\u0430\u0432\u043d\u043e\u0435 \u043c\u0435\u043d\u044e"})]})]})},L=c.p+"static/media/pirate.f59fc226.jpg",F=c.p+"static/media/zinger.96f760ef.jpg",A=c.p+"static/media/ostankino.9be6a3a4.jpg",K=c.p+"static/media/metro.3273fc31.jpg",V=c(171),W=function(e){var t=e.id,c=e.go,s=(e.locations,e.setLoc),i=Object(n.useState)([""]),a=Object(l.a)(i,2),r=a[0],j=a[1],d=Object(n.useState)(""),b=Object(l.a)(d,2),u=b[0],h=b[1],x=Object(n.useState)(null),f=Object(l.a)(x,2),p=f[0],g=f[1];return Object(m.jsxs)(O.n,{id:t,children:[Object(m.jsx)(O.o,{left:Object(m.jsx)(O.p,{onClick:c,"data-to":"locs"}),children:"\u041d\u043e\u0432\u0430\u044f \u043b\u043e\u043a\u0430\u0446\u0438\u044f"}),Object(m.jsx)(O.j,{children:"\u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0435"}),Object(m.jsxs)(O.i,{children:[Object(m.jsx)(O.h,{top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043b\u043e\u043a\u0430\u0446\u0438\u0438",children:Object(m.jsx)(O.m,{placeholder:"\u041d\u0435\u043e\u0431\u0438\u0442\u0430\u0435\u043c\u044b\u0439 \u043e\u0441\u0442\u0440\u043e\u0432",value:u,onChange:function(e){return h(e.target.value)}})}),Object(m.jsxs)(O.h,{top:"\u041e\u0431\u043b\u043e\u0436\u043a\u0430",children:[Object(m.jsx)(O.g,{before:Object(m.jsx)(V.a,{}),controlSize:"m",mode:"secondary",onChange:function(e){return function(e){var t=URL.createObjectURL(e.target.files[0]);console.log(t),g(t)}(e)}}),p?Object(m.jsx)("img",{style:{width:"100%",height:"280px",objectFit:"cover",borderRadius:"8px",marginTop:"16px"},src:p}):null]})]}),Object(m.jsxs)(O.i,{children:[Object(m.jsx)(O.j,{children:"\u0420\u043e\u043b\u0438"}),r?r.map((function(e,t){return Object(m.jsx)(O.h,{top:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0440\u043e\u043b\u0438",children:Object(m.jsx)(O.m,{placeholder:"\u0413\u0440\u0443\u0437\u0447\u0438\u043a",value:e.value,onChange:function(e){return function(e,t){j([].concat(Object(o.a)(r.slice(0,e)),[t.target.value],Object(o.a)(r.slice(e+1))))}(t,e)}})},t)})):null,Object(m.jsx)(O.f,{children:Object(m.jsx)(O.d,{stretched:!0,mode:"secondary",size:"m",onClick:function(){return j([].concat(Object(o.a)(r),[""]))},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0440\u043e\u043b\u044c"})})]}),Object(m.jsx)(O.i,{children:Object(m.jsx)(O.f,{children:Object(m.jsx)(O.d,{stretched:!0,size:"m","data-to":"locs",onClick:function(e){s(JSON.stringify({img:p,location:u,role:r})),c(e)},children:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"})})})]})},U=u.a.connect("https://62.113.111.234:3001"),E=function(){var e=Object(n.useState)("bright_light"),t=Object(l.a)(e,2),c=t[0],s=t[1],i=Object(n.useState)("home"),a=Object(l.a)(i,2),d=a[0],u=a[1],h=Object(n.useState)(null),x=Object(l.a)(h,2),p=x[0],g=x[1],v=Object(n.useState)(Object(m.jsx)(O.q,{size:"large"})),_=Object(l.a)(v,2),k=(_[0],_[1]),z=Object(n.useState)(null),N=Object(l.a)(z,2),T=N[0],V=N[1],E=Object(n.useState)(null),J=Object(l.a)(E,2),R=J[0],I=J[1],D=Object(n.useState)(null),G=Object(l.a)(D,2),M=G[0],q=G[1],B=Object(n.useState)(null),P=Object(l.a)(B,2),Q=P[0],Y=P[1],H=Object(n.useState)(null),X=Object(l.a)(H,2),Z=X[0],$=X[1],ee=Object(n.useState)([{img:L,location:"\u041f\u0438\u0440\u0430\u0442\u0441\u043a\u0438\u0439 \u043a\u043e\u0440\u0430\u0431\u043b\u044c",role:["\u042e\u043d\u0433\u0430","\u041f\u043b\u0435\u043d\u043d\u044b\u0439","\u041f\u043e\u043f\u0443\u0433\u0430\u0439 \u043d\u0430 \u043f\u043b\u0435\u0447\u0435","\u0411\u043e\u0446\u043c\u0430\u043d","\u041a\u0430\u043f\u0438\u0442\u0430\u043d","\u041f\u043b\u043e\u0442\u043d\u0438\u043a"]},{img:F,location:"\u041e\u0444\u0438\u0441 \u0412\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u0435",role:["\u041c\u0435\u043d\u0435\u0434\u0436\u0435\u0440","\u0422\u0438\u043c\u043b\u0438\u0434","\u0422\u0435\u0441\u0442\u0438\u0440\u043e\u0432\u0449\u0438\u043a","\u0420\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0447\u0438\u043a","\u0421\u0438\u0441 \u0430\u0434\u043c\u0438\u043d","\u0423\u0431\u043e\u0440\u0449\u0438\u043a"]},{img:A,location:"\u041e\u0441\u0442\u0430\u043d\u043a\u0438\u043d\u043e",role:["\u0414\u0438\u0440\u0435\u043a\u0442\u043e\u0440","\u0420\u0435\u043f\u043e\u0440\u0442\u0451\u0440","\u0416\u0443\u0440\u043d\u0430\u043b\u0438\u0441\u0442","\u041e\u043f\u0435\u0440\u0430\u0442\u043e\u0440","\u0422\u0435\u043b\u0435\u0437\u0432\u0435\u0437\u0434\u0430","\u041c\u0435\u0442\u0435\u043e\u0440\u043e\u043b\u043e\u0433"]},{img:K,location:"\u041c\u0435\u0442\u0440\u043e",role:["\u0421\u043b\u0435\u0441\u0430\u0440\u044c","\u042d\u043b\u0435\u043a\u0442\u0440\u043e\u043c\u043e\u043d\u0442\u0430\u0436\u043d\u0438\u043a","\u041d\u0430\u0447\u0430\u043b\u044c\u043d\u0438\u043a \u0441\u043c\u0435\u043d\u044b","\u041f\u0440\u043e\u0440\u0430\u0431","\u041c\u0430\u0448\u0438\u043d\u0438\u0441\u0442","\u0418\u043d\u0436\u0435\u043d\u0435\u0440"]}]),te=Object(l.a)(ee,2),ce=te[0],ne=te[1];Object(n.useEffect)((function(){function e(){return(e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.a.send("VKWebAppGetUserInfo");case 2:t=e.sent,g(t),k(null);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}r.a.send("VKWebAppInit"),r.a.subscribe((function(e){var t=e.detail,c=t.type,n=t.data;"VKWebAppUpdateConfig"===c&&s(n.scheme)})),function(){e.apply(this,arguments)}()}),[]);var se=function(e){u(e.currentTarget.dataset.to),e.currentTarget.dataset.mafia&&I(e.currentTarget.dataset.mafia)},ie=function(){r.a.send("VKWebAppFlashSetLevel",{level:1}),setTimeout((function(){r.a.send("VKWebAppFlashSetLevel",{level:0})}),1e3),setTimeout((function(){r.a.send("VKWebAppFlashSetLevel",{level:1})}),2e3),setTimeout((function(){r.a.send("VKWebAppFlashSetLevel",{level:0})}),3e3),setTimeout((function(){r.a.send("VKWebAppFlashSetLevel",{level:1})}),4e3),setTimeout((function(){r.a.send("VKWebAppFlashSetLevel",{level:0})}),5e3)};return Object(n.useEffect)((function(){U.on("game_info",(function(e){ne(e.locations),V(e.users),q(e.room),$(e.location),Y(e.spy),setTimeout((function(){u("game")}),300)}))}),[U]),Object(m.jsx)(O.e,{scheme:c,children:Object(m.jsx)(O.a,{children:Object(m.jsx)(O.b,{children:Object(m.jsx)(O.s,{children:Object(m.jsx)(O.r,{children:Object(m.jsxs)(O.t,{activePanel:d,children:[Object(m.jsx)(f,{id:"home",fetchedUser:p,go:se}),Object(m.jsx)(y,{id:"locs",locations:ce,setLocations:ne,go:se}),Object(m.jsx)(S,{id:"new",socket:U,locations:ce,room:M,changeRoom:function(e){q(JSON.parse(e.currentTarget.dataset.to.id))},fetchedUser:p,go:se,play:function(e){var t=JSON.parse(e.currentTarget.dataset.users),c=[p].concat(Object(o.a)(t));V(c),u(e.currentTarget.dataset.to)}}),Object(m.jsx)(C,{id:"game",spy:Q,location:Z,room:M,socket:U,flash:ie,fetchedUser:p,setRoom:q,go:se,locations:ce,players:T}),Object(m.jsx)(w,{id:"timer",mafia:R,bridge:r.a,go:se,flash:ie,players:T}),Object(m.jsx)(W,{id:"newLocation",go:se,locations:ce,setLoc:function(e){var t=JSON.parse(e);ne([t].concat(Object(o.a)(ce)))}})]})})})})})})};r.a.send("VKWebAppInit"),i.a.render(Object(m.jsx)(E,{}),document.getElementById("root"))},38:function(e,t,c){e.exports={location:"location_location__6OsAv",img:"location_img__2fTr_",title:"location_title__3yYNt",role:"location_role__2E_E7"}},39:function(e,t,c){e.exports={timer:"timer_timer__3onDo",text:"timer_text__1av19",btn:"timer_btn__3Qc1g"}},48:function(e,t,c){e.exports={btn:"home_btn__3c_e8"}}},[[170,1,2]]]);
//# sourceMappingURL=main.adf96104.chunk.js.map